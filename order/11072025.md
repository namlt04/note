
# cấu trúc của LPDRAWITEMSTRUCT
typedef struct tagDRAWITEMSTRUCT {
    UINT  CtlType;       // Loại control (ODT_BUTTON, ODT_MENU, ...)
    UINT  CtlID;         // ID của control (ID trong dialog/resource)
    UINT  itemID;        // Index của item (nếu là menu/listbox)
    UINT  itemAction;    // Hành động cần thực hiện (vẽ/redraw)
    UINT  itemState;     // Trạng thái hiện tại (ODS_SELECTED, ODS_DISABLED,...)
    HWND  hwndItem;      // Handle của control (nút, listbox,...)
    HDC   hDC;           // Device context dùng để vẽ
    RECT  rcItem;        // Kích thước/tọa độ vùng vẽ
    ULONG_PTR itemData;  // Dữ liệu bổ sung (ví dụ: từ AddString(..., LPARAM))
} DRAWITEMSTRUCT;

# các cờ của itemSttate
| Cờ (`ODS_...`)    | Giá trị (Hex) | Ý nghĩa                                                                                          |
| ----------------- | ------------- | ------------------------------------------------------------------------------------------------ |
| `ODS_SELECTED`    | `0x0001`      | Control đang được chọn (với button: đang nhấn chuột)                                             |
| `ODS_GRAYED`      | `0x0002`      | Không sử dụng nữa (đã thay bằng `ODS_DISABLED`)                                                  |
| `ODS_DISABLED`    | `0x0004`      | Control bị vô hiệu hóa (grayed out)                                                              |
| `ODS_CHECKED`     | `0x0008`      | Item được đánh dấu (ví dụ menu item có dấu tick)                                                 |
| `ODS_FOCUS`       | `0x0010`      | Control đang có focus (vẽ khung nét đứt quanh)                                                   |
| `ODS_DEFAULT`     | `0x0020`      | Là button mặc định (default button trong dialog)                                                 |
| `ODS_HOTLIGHT`    | `0x0040`      | Con trỏ chuột đang hover lên control (chỉ hỗ trợ với một số control đặc biệt hoặc Windows theme) |
| `ODS_INACTIVE`    | `0x0080`      | Item hiện tại không active (hiếm dùng)                                                           |
| `ODS_NOACCEL`     | `0x0100`      | Không vẽ ký tự accelerator (Alt + key)                                                           |
| `ODS_NOFOCUSRECT` | `0x0200`      | Không vẽ khung nét đứt focus                                                                     |

# dwStyle : giá trị kiểu DWORD ( 2 byte), tập hợp kiểu thuộc tính của window hoặc control trong Windows API hoặc MFC
( tương tự 1 số nguyên không dấu, 32 bit)
Windows xử lí dwStyle thế nào?
+ dùng toán tử bit & để kiểm tra các cờ
VD : (dwStyle & WS_VISIBLE) 
thường được biểu diễn bởi hệ thập lục phân ( 0x) 
ví dụ
#define WS_CHILD        0x40000000


# Hàm presubclass 
hàm này sẽ chạy trước DrawItem, sau khi Create


# Ghi đè Override, thường dùng cho hàm con
giữ nguyên mẫu hàm cha, hàm cha vẫn còn đó, nhưng khi gọi hàm này, nó sẽ gọi hàm ở con 

# từ khóa virtual 
khi kế thừa 1 class, nhưng muốn override class đó
pattern của PreSubclassWindow() 

void PreSubclassWindow()
** Nếu muốn giữ nguyên , gọi đến PreSubclass của hàm cha 
    VD : CButton::PreSubclassWindow()


# Update lại vùng vẽ 
void UpdateRegion()
    {
        CRect rect;
        GetClientRect(&rect); // lấy vùng khởi tạo định vẽ
        if (m_rgn)
            DeleteObject(m_rgn); // xóa vùng hiện tại
        m_rgn = CreateEllipticRgn(rect.left, rect.top, rect.right, rect.bottom);
        // tạo vùng vẽ mới
        SetWindowRgn(m_rgn, TRUE);

    }


CreateRectRgn // Tạo vùng hình chữ nhật
 Ví dụ: 
 ```cpp 
 m_hRgn = CreateRectRgn(left, top, right, bottom); 
 ```

#### CreateEllipticRgn 
 Tạo Hình Elip nằm trong vùng hình chữ nhật
```cpp
m_hRgn = CreateEllipticRgn(left, top, right, bottom);
```
#### CreatePolygonRgn
 Tạo vùng hình đa giác 

POINT pts[] = {
    {50, 10},
    {150, 10},
    {100, 100}
};
HRGN hRgn = CreatePolygonRgn(pts, 3, WINDING); 
HRGN CreatePolygonRgn(
  const POINT *lppt, // mảng các điểm
  int cPoints,       // số lượng điểm
  int fnPolyFillMode // kiểu tô vùng: ALTERNATE hoặc WINDING

);
ALTERNATE : Even - odd 
winding : non zero widning
#### CreateRoundRectRgn // tạo vùng hình chữ nhật đa giác
```cpp
m_hRgn = CreateRoundRectRgn(left, top,right, bottom,  int nWidthEllipse,  , int nHeightEllipse  ); 
```

các hàm dùng để tạo HRGN


::DrawIconEx(dc.GetSafeHdc(), 100, 100, hIcon, 64, 64, 0, NULL, DI_NORMAL);





BOOL DrawIconEx(
  HDC hdc,        // DC để vẽ
  int xLeft,      // Vị trí X
  int yTop,       // Vị trí Y
  HICON hIcon,    // Icon cần vẽ
  int cxWidth,    // Chiều rộng (0 = dùng kích thước gốc)
  int cyWidth,    // Chiều cao
  UINT istepIfAniCur, // Bỏ qua, để 0
  HBRUSH hbrFlickerFreeDraw, // Brush nền hoặc NULL
  UINT diFlags    // Cờ (DI_NORMAL, DI_IMAGE, DI_MASK, v.v.)
);