# Window message 
C∆° ch·∫ø x·ª≠ l√≠ s·ª± ki·ªán gi·ªØa h·ªá th·ªëng v√† ·ª©ng d·ª•ng
+ Khi ng∆∞·ªùi d√πng nh·∫•n chu·ªôt, g√µ ph√≠m, ho·∫∑c h·ªá ƒëi·ªÅu h√†nh thay ƒë·ªïi tr·∫°ng th√°i. Windows t·∫°o ra th√¥ng ƒëi·ªáp v√† g·ª≠i ƒë·∫øn Window procedure ( h√†m x·ª≠ l√≠ th√¥ng ƒëi·ªáp c·ªßa c·ª≠a s·ªï t∆∞∆°ng ·ª©ng )
# C·∫•u tr√∫c th√¥ng ƒëi·ªáp 
Th√¥ng ƒëi·ªáp ƒë∆∞·ª£c g·ª≠i qua m·ªôt c·∫•u tr√∫c g·ªçi l√† MSG
typdef struct tagMSG{ 

} MSG; // MSG : c√°ch ƒë·∫∑t alias
# ƒëƒÉt b√≠ danh : typedef 
typedef longlong ll : thay v√¨ vi·∫øt long long, ch·ªâ c·∫ßn vi·∫øt ll 
typdef <ki·ªÉu d·ªØ li·ªáu> <b√≠ danh>

# ghi ƒë√® : l·ªõp cha h√†m ƒë√≥ ph·∫£i l√† virtual : t·ª´ kh√≥a virtual cho ph√©p h√†m ƒë√≥ override

# V√≤ng l·∫∑p th√¥ng ƒëi·ªáp ( Message Loop)
MFC / Win32 d√πng v√≤ng l·∫∑p ƒë·ªÉ l·∫•y th√¥ng ƒëi·ªáp 
MSG msg;
while (GetMessage(&msg, NULL, 0, 0)) {
    TranslateMessage(&msg); // X·ª≠ l√Ω ph√≠m
    DispatchMessage(&msg);  // G·ª≠i ƒë·∫øn Window Procedure
}
# H√†m x·ª≠ l√≠ th√¥ng ƒëi·ªáp 
Nh·∫≠n v√† x·ª≠ l√≠ th√¥ng ƒëi·ªáp

# X·ª≠ l√≠ th√¥ng ƒëi·ªáp trong MFC 
Th·ª±c hi·ªán gi√°n ti·∫øp th√¥ng qua Message Map 
+ Windows g·ª≠i Message ƒë·∫øn c·ª≠a s·ªï 
+ MFC chuy·ªÉn message denn691 m·ªôt Message Map 
+ G·ªçi t·ªõi h√†m x·ª≠  l√≠ t∆∞∆°ng ·ª©ng m√† t·ª± ƒë·ªãnh nghƒ©a


# C√∫ ph√°p t·ª± ƒë·ªãnh nghƒ©a h√†m x·ª≠ l√≠ th√¥ng ƒëi·ªáp ( Window procedues )
1. ƒê·ªãnh nghƒ©a th√¥ng ƒëi·ªáp
2. Khai b√°o h√†m x·ª≠ l√≠
afx_msg value_return functionName(); 
afx_msg : macro ƒë·∫∑c bi·ªát trong mfc, ƒë√°nh d·∫•u l√† c√°c h√†m x·ª≠ l√≠ th√¥ng ƒëi·ªáp ( gi√∫p ph√¢n bi·ªát h√†m x·ª≠ l√≠ th√¥ng ƒëi·ªáp v·ªõi c√°c h√†m th√¥ng th∆∞·ªùng)
3. ƒêƒÉng k√≠ trong BEGIN_MESSAGE_MAP
C√∫ ph√°p : 
THONG_DIEP(MA_THONG_DIEP, &Class::Ham_xu_li)

# Tham s·ªë h√†m x·ª≠ l√≠ th√¥ng ƒëi·ªáp
wParam v√† lParam l√† 2 tham s·ªë ch√≠nh ƒëi k√®m v·ªõi m·ªçi Windows message

LRESULT CALLBACK WindowProc(
    HWND hwnd,      // Handle c·ª≠a s·ªï nh·∫≠n th√¥ng ƒëi·ªáp
    UINT uMsg,      // M√£ th√¥ng ƒëi·ªáp (WM_XXX)
    WPARAM wParam,  // D·ªØ li·ªáu 1 (ki·ªÉu UINT_PTR - th∆∞·ªùng 32/64 bit)
    LPARAM lParam   // D·ªØ li·ªáu 2 (ki·ªÉu LONG_PTR - th∆∞·ªùng 32/64 bit)
);

UINT : Unsigned Integer : ki·ªÉu d·ªØ li·ªáu ƒë·ªÉ l∆∞u s·ªë nguy√™n kh√¥ng √¢m ( 4 byte)
#define WM_NULL                         0x0000
#define WM_CREATE                       0x0001
#define WM_DESTROY                      0x0002
...
#define WM_USER                         0x0400 

Th∆∞·ªùng s·ª≠ d·ª•ng UINT ƒë·ªÉ ƒë·ªãnh nghƒ©a cho c√°c h·∫±ng s·ªë

# L√†m th·∫ø n√†o ƒë·ªÉ bi·∫øt h√†m x·ª≠ l√≠ th√¥ng ƒëi·ªáp c√≥ bao nhi√™u tham s·ªë v√† ch√∫ng l√† g√¨
1. Tra b·∫£ng WM_
2. Xem header c·ªßa MFC
# WM_NOTIFY l√† m·ªôt th√¥ng ƒëi·ªáp (message) do h·ªá ƒëi·ªÅu h√†nh Windows g·ª≠i ƒë·∫øn c·ª≠a s·ªï cha (parent window) khi m·ªôt control chu·∫©n nh∆∞ ListView, TreeView, Header, Tab, Toolbar... c·∫ßn th√¥ng b√°o m·ªôt s·ª± ki·ªán g√¨ ƒë√≥ ‚Äî v√≠ d·ª•: ng∆∞·ªùi d√πng click chu·ªôt, s·∫Øp v·∫Ω, s·ª≠a n·ªôi dung, v.v.



# Trong mfc, m·ªçi ƒë·ªëi t∆∞·ª£ng k·∫ø th·ª´a t·ª´ CWnd ƒë·ªÅu c√≥ Handle window : HWND

# khi t·∫°o button trong mfc, vi·ªác khai b√°o n√≥ ·ªü trong file.h m·ªõi ch·ªâ l√† bi·∫øn gi√∫p qu·∫£n l√≠ n√≥, ch·ª© n√≥ ch∆∞a th·ª±c s·ª± ƒë∆∞·ª£c t·∫°o l√™n m√†n h√¨nh. ph·∫£i s·ª≠ dugn5 create m·ªõi ho√†n t·∫•t vi·ªác t·∫°o button

# WS_CHILD: style ( c·ªù - flag)
Windows style : child : c·ª≠a s·ªï n√†y, control n√†y l√† con c·ªßa 1 c·ª≠a s·ªë kh√°c v√† n√≥ s·ªëng b√™n trong v√πng client, c·ªßa c·ª≠a s·ªï cha ƒë√≥ 
- n√≥ s·∫Ω b·ªã : 
+ gi·ªõi h·∫°n v√†o kh√¥ng gian c·ªßa parent
+ t·ª± h·ªßy khi cha h·ªßy
- N·∫øu kh√¥ng c√≥ WS_CHILD : n√∫t s·∫Ω kh√¥ng ƒë∆∞·ª£c g·∫Øn v√†o c·ª≠a s·ªï cha, c√≥ th·ªÉ l·ªói hi·ªÉn th·ªã

c√°ch vi·∫øt kh√°c : WS_CHILDWINDOW

cac Windows style kh√°c


WS_OVERLAPPED	0x00000000L	C·ª≠a s·ªï ch·ªìng, c√≥ th·ªÉ c√≥ title, border (d√πng cho top-level window)
WS_POPUP	0x80000000L	C·ª≠a s·ªï popup (kh√¥ng c√≥ border/title m·∫∑c ƒë·ªãnh)
WS_CHILD	0x40000000L	C·ª≠a s·ªï con (c·∫ßn parent window)
WS_VISIBLE	0x10000000L	Hi·ªÉn th·ªã c·ª≠a s·ªï ( window, control) khi t·∫°o 
WS_DISABLED	0x08000000L	Kh√¥ng t∆∞∆°ng t√°c ƒë∆∞·ª£c
WS_MINIMIZE	0x20000000L	B·∫Øt ƒë·∫ßu v·ªõi tr·∫°ng th√°i thu nh·ªè
WS_MAXIMIZE	0x01000000L	B·∫Øt ƒë·∫ßu v·ªõi tr·∫°ng th√°i ph√≥ng to
WS_CAPTION	
WS_BORDER	
WS_DLGFRAME
WS_SYSMENU	0x00080000L	C√≥ menu h·ªá th·ªëng (Alt + Space)
WS_THICKFRAME	0x00040000L	C√≥ th·ªÉ resize c·ª≠a s·ªï
WS_MINIMIZEBOX	0x00020000L	C√≥ n√∫t thu nh·ªè
WS_MAXIMIZEBOX	0x00010000L	C√≥ n√∫t ph√≥ng to

CStatic : 
Static Style


# CRect (left, top, right, bottom)
width = right - left
height = bottom - top


# lp....
Near pointer: 16-bit, ch·ªâ tr·ªè trong 1 segment.

Far/Long pointer: 32-bit, tr·ªè ƒë∆∞·ª£c to√†n b·ªô memory.

# C·∫•u tr√∫c nmcustomdraw

dwDrawStage: giai ƒëo·∫°n v·∫Ω
Global Values:
CDDS_POSTERASE
After the erasing cycle is complete.
CDDS_POSTPAINT
After the painting cycle is complete.
CDDS_PREERASE
Before the erasing cycle begins.
CDDS_PREPAINT
Before the painting cycle begins.
Item-specific Values:
CDDS_ITEM
Indicates that the dwItemSpec, uItemState, and lItemlParam members are valid.
CDDS_ITEMPOSTERASE
After an item has been erased.
CDDS_ITEMPOSTPAINT
After an item has been drawn.
CDDS_ITEMPREERASE
Before an item is erased.
CDDS_ITEMPREPAINT
Before an item is drawn.
CDDS_SUBITEM
Flag combined with CDDS_ITEMPREPAINT or CDDS_ITEMPOSTPAINT if a subitem is being drawn. This will only be set if CDRF_NOTIFYITEMDRAW is returned from CDDS_PREPAINT.


# RFConstant 
https://learn.microsoft.com/en-us/windows/win32/controls/cdrf-constants


CDRF_DODEFAULT
0x00000000
The control will draw itself. It will not send any additional NM_CUSTOMDRAW notification codes for this paint cycle. This occurs when the dwDrawStage of the NMCUSTOMDRAW structure equals CDDS_PREPAINT.
CDRF_NEWFONT
0x00000002
The application specified a new font for the item; the control will use the new font. For more information about changing fonts, see Changing fonts and colors. This occurs when the dwDrawStage of the NMCUSTOMDRAW structure equals CDDS_ITEMPREPAINT.
CDRF_SKIPDEFAULT
0x00000004
The application drew the item manually. The control will not draw the item. This occurs when the dwDrawStage of the NMCUSTOMDRAW structure equals CDDS_ITEMPREPAINT.
CDRF_DOERASE
0x00000008
Windows Vista and later. The control will draw the background.
CDRF_NOTIFYPOSTPAINT
0x00000010
The control will notify the parent after painting an item. This occurs when the dwDrawStage of the NMCUSTOMDRAW structure equals CDDS_PREPAINT.
CDRF_NOTIFYITEMDRAW
0x00000020
The control will notify the parent of any item-related drawing operations. It will send NM_CUSTOMDRAW notification codes before and after drawing items. This occurs when the dwDrawStage of the NMCUSTOMDRAW structure equals CDDS_PREPAINT.
CDRF_NOTIFYSUBITEMDRAW
0x00000020
Internet Explorer 4.0 and later. The control will notify the parent of any item-related drawing operations. It will send NM_CUSTOMDRAW notification codes before and after drawing items. This occurs when the dwDrawStage of the NMCUSTOMDRAW structure equals CDDS_PREPAINT. This flag is identical to CDRF_NOTIFYITEMDRAW and its use is context-dependent.
CDRF_NOTIFYPOSTERASE
0x00000040
The control will notify the parent after erasing an item. This occurs when the dwDrawStage of the NMCUSTOMDRAW structure equals CDDS_PREPAINT.
CDRF_SKIPPOSTPAINT
0x00000100
Windows Vista and later. The control will not draw the focus rectangle.



D∆∞·ªõi ƒë√¢y l√† b·∫£n d·ªãch ti·∫øng Vi·ªát c·ªßa c√°c gi√° tr·ªã h·∫±ng s·ªë `CDRF_` d√πng trong x·ª≠ l√Ω `NM_CUSTOMDRAW` (v·∫Ω t√πy ch·ªânh trong c√°c control nh∆∞ ListView, TreeView\...) trong Windows:

---

### üü¶ `CDRF_DODEFAULT` (0x00000000)

**M·∫∑c ƒë·ªãnh:** Control s·∫Ω t·ª± v·∫Ω.
‚Üí Kh√¥ng g·ª≠i th√™m th√¥ng b√°o `NM_CUSTOMDRAW` n√†o kh√°c trong chu k·ª≥ v·∫Ω n√†y.
‚Üí ƒêi·ªÅu n√†y x·∫£y ra khi `dwDrawStage` trong `NMCUSTOMDRAW` b·∫±ng `CDDS_PREPAINT`.

---

### üü¶ `CDRF_NEWFONT` (0x00000002)

**D√πng font m·ªõi:** ·ª®ng d·ª•ng ƒë√£ ch·ªâ ƒë·ªãnh m·ªôt font m·ªõi cho item.
‚Üí Control s·∫Ω s·ª≠ d·ª•ng font m·ªõi ƒë√≥.
‚Üí √Åp d·ª•ng khi `dwDrawStage` = `CDDS_ITEMPREPAINT`.

---

### üü¶ `CDRF_SKIPDEFAULT` (0x00000004)

**B·ªè qua v·∫Ω m·∫∑c ƒë·ªãnh:** ·ª®ng d·ª•ng ƒë√£ t·ª± v·∫Ω item b·∫±ng tay.
‚Üí Control **kh√¥ng v·∫Ω l·∫°i** item n·ªØa.
‚Üí √Åp d·ª•ng khi `dwDrawStage` = `CDDS_ITEMPREPAINT`.

---

### üü¶ `CDRF_DOERASE` (0x00000008) *(Ch·ªâ t·ª´ Windows Vista tr·ªü l√™n)*

**V·∫Ω n·ªÅn:** Control s·∫Ω t·ª± v·∫Ω n·ªÅn background.

---

### üü¶ `CDRF_NOTIFYPOSTPAINT` (0x00000010)

**Th√¥ng b√°o sau khi v·∫Ω:** Control s·∫Ω th√¥ng b√°o cho c·ª≠a s·ªï cha **sau khi v·∫Ω xong m·ªôt item**.
‚Üí √Åp d·ª•ng khi `dwDrawStage` = `CDDS_PREPAINT`.

---

### üü¶ `CDRF_NOTIFYITEMDRAW` (0x00000020)

**Th√¥ng b√°o tr∆∞·ªõc v√† sau khi v·∫Ω t·ª´ng item:**
‚Üí Control s·∫Ω g·ª≠i th√¥ng b√°o `NM_CUSTOMDRAW` **tr∆∞·ªõc v√† sau khi v·∫Ω c√°c item**.
‚Üí √Åp d·ª•ng khi `dwDrawStage` = `CDDS_PREPAINT`.

---

### üü¶ `CDRF_NOTIFYSUBITEMDRAW` (0x00000020) *(T·ª´ Internet Explorer 4.0 tr·ªü ƒëi)*

**T∆∞∆°ng ƒë∆∞∆°ng v·ªõi `CDRF_NOTIFYITEMDRAW`, nh∆∞ng d√πng trong ng·ªØ c·∫£nh c√≥ nhi·ªÅu c·ªôt (subitem)**.
‚Üí C√πng gi√° tr·ªã v√† √Ω nghƒ©a, nh∆∞ng ph√¢n bi·ªát ng·ªØ c·∫£nh d√πng v·ªõi `ListView` d·∫°ng report.

---

### üü¶ `CDRF_NOTIFYPOSTERASE` (0x00000040)

**Th√¥ng b√°o sau khi x√≥a n·ªÅn (erase):**
‚Üí Control s·∫Ω th√¥ng b√°o cho c·ª≠a s·ªï cha sau khi x√≥a n·ªÅn m·ªôt item.
‚Üí √Åp d·ª•ng khi `dwDrawStage` = `CDDS_PREPAINT`.

---

### üü¶ `CDRF_SKIPPOSTPAINT` (0x00000100) *(Windows Vista tr·ªü l√™n)*

**B·ªè qua v·∫Ω h·∫≠u k·ª≥:** Control **kh√¥ng v·∫Ω ƒë∆∞·ªùng vi·ªÅn focus (focus rectangle)**.

---

N·∫øu b·∫°n c·∫ßn v√≠ d·ª• minh h·ªça c√°ch d√πng t·ª´ng gi√° tr·ªã trong `CListCtrl` hay `CListView`, m√¨nh c√≥ th·ªÉ cung c·∫•p th√™m.



https://learn.microsoft.com/en-us/windows/win32/winmsg/about-messages-and-message-queues



WM_NOTIFY l√† 1 window message ƒë·∫∑c bi·ªát, ch·ª©a c√°c th√¥ng b√°o con